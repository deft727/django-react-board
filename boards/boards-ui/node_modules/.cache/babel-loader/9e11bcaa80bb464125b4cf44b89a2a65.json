{"ast":null,"code":"import _objectWithoutProperties from \"/home/user/Desktop/react_board/boards/boards-ui/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"PreviewComponent\", \"previewMethodsRef\", \"onPreviewsChanged\"];\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport React, { useCallback, useEffect, useImperativeHandle } from \"react\";\nimport usePreviewsLoader from \"./usePreviewsLoader\";\nimport { getFallbackUrlData } from \"./utils\";\nimport { PREVIEW_TYPES } from \"./consts\";\n\nvar showBasicPreview = function showBasicPreview(type, url, previewProps, onImgError) {\n  return type === PREVIEW_TYPES.VIDEO ? /*#__PURE__*/React.createElement(\"video\", _extends({\n    key: url,\n    src: url,\n    controls: true\n  }, previewProps)) : /*#__PURE__*/React.createElement(\"img\", _extends({\n    key: url,\n    onError: onImgError,\n    src: url\n  }, previewProps));\n};\n\nvar usePreviewMethods = function usePreviewMethods(previews, clearPreviews, previewMethodsRef, onPreviewsChanged) {\n  useImperativeHandle(previewMethodsRef, function () {\n    return {\n      clear: clearPreviews\n    };\n  }, [clearPreviews]);\n  useEffect(function () {\n    if (onPreviewsChanged) {\n      onPreviewsChanged(previews);\n    }\n  }, [previews, onPreviewsChanged]);\n};\n\nvar UploadPreview = function UploadPreview(props) {\n  var PreviewComponent = props.PreviewComponent,\n      previewMethodsRef = props.previewMethodsRef,\n      onPreviewsChanged = props.onPreviewsChanged,\n      previewOptions = _objectWithoutProperties(props, _excluded);\n\n  var _usePreviewsLoader = usePreviewsLoader(previewOptions),\n      previews = _usePreviewsLoader.previews,\n      clearPreviews = _usePreviewsLoader.clearPreviews;\n\n  var onImagePreviewLoadError = useCallback(function (e) {\n    var img = e.target;\n    var fallback = getFallbackUrlData(props.fallbackUrl, img.src);\n\n    if (fallback) {\n      img.src = fallback.url;\n    }\n  }, [props.fallbackUrl]);\n  usePreviewMethods(previews, clearPreviews, previewMethodsRef, onPreviewsChanged);\n  return previews.map(function (data) {\n    var id = data.id,\n        url = data.url,\n        type = data.type,\n        name = data.name,\n        isFallback = data.isFallback,\n        previewProps = data.props;\n    return PreviewComponent ? /*#__PURE__*/React.createElement(PreviewComponent, _extends({\n      key: id + url,\n      id: id,\n      url: url,\n      type: type,\n      name: name,\n      isFallback: isFallback\n    }, previewProps)) : showBasicPreview(type, url, previewProps, onImagePreviewLoadError);\n  });\n};\n\nexport default UploadPreview;","map":{"version":3,"sources":["/home/user/Desktop/react_board/boards/boards-ui/node_modules/@rpldy/upload-preview/lib/esm/UploadPreview.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","React","useCallback","useEffect","useImperativeHandle","usePreviewsLoader","getFallbackUrlData","PREVIEW_TYPES","showBasicPreview","type","url","previewProps","onImgError","VIDEO","createElement","src","controls","onError","usePreviewMethods","previews","clearPreviews","previewMethodsRef","onPreviewsChanged","clear","UploadPreview","props","PreviewComponent","previewOptions","onImagePreviewLoadError","e","img","fallback","fallbackUrl","map","data","id","name","isFallback"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useCallback, useEffect, useImperativeHandle } from \"react\";\nimport usePreviewsLoader from \"./usePreviewsLoader\";\nimport { getFallbackUrlData } from \"./utils\";\nimport { PREVIEW_TYPES } from \"./consts\";\n\nconst showBasicPreview = (type, url, previewProps, onImgError) => type === PREVIEW_TYPES.VIDEO ? /*#__PURE__*/React.createElement(\"video\", _extends({\n  key: url,\n  src: url,\n  controls: true\n}, previewProps)) : /*#__PURE__*/React.createElement(\"img\", _extends({\n  key: url,\n  onError: onImgError,\n  src: url\n}, previewProps));\n\nconst usePreviewMethods = (previews, clearPreviews, previewMethodsRef, onPreviewsChanged) => {\n  useImperativeHandle(previewMethodsRef, () => ({\n    clear: clearPreviews\n  }), [clearPreviews]);\n  useEffect(() => {\n    if (onPreviewsChanged) {\n      onPreviewsChanged(previews);\n    }\n  }, [previews, onPreviewsChanged]);\n};\n\nconst UploadPreview = props => {\n  const {\n    PreviewComponent,\n    previewMethodsRef,\n    onPreviewsChanged,\n    ...previewOptions\n  } = props;\n  const {\n    previews,\n    clearPreviews\n  } = usePreviewsLoader(previewOptions);\n  const onImagePreviewLoadError = useCallback(e => {\n    const img = e.target;\n    const fallback = getFallbackUrlData(props.fallbackUrl, img.src);\n\n    if (fallback) {\n      img.src = fallback.url;\n    }\n  }, [props.fallbackUrl]);\n  usePreviewMethods(previews, clearPreviews, previewMethodsRef, onPreviewsChanged);\n  return previews.map(data => {\n    const {\n      id,\n      url,\n      type,\n      name,\n      isFallback,\n      props: previewProps\n    } = data;\n    return PreviewComponent ? /*#__PURE__*/React.createElement(PreviewComponent, _extends({\n      key: id + url,\n      id: id,\n      url: url,\n      type: type,\n      name: name,\n      isFallback: isFallback\n    }, previewProps)) : showBasicPreview(type, url, previewProps, onImagePreviewLoadError);\n  });\n};\n\nexport default UploadPreview;"]},"metadata":{},"sourceType":"module"}