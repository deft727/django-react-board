{"ast":null,"code":"import _regeneratorRuntime from\"/home/user/Desktop/react_board/boards/boards-ui/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/user/Desktop/react_board/boards/boards-ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/user/Desktop/react_board/boards/boards-ui/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/home/user/Desktop/react_board/boards/boards-ui/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3;import React,{useState,useCallback,useRef}from\"react\";import styled from\"styled-components\";import ReactCrop from\"react-image-crop\";import\"react-image-crop/dist/ReactCrop.css\";import Uploady,{withRequestPreSendUpdate,useItemFinalizeListener}from\"@rpldy/uploady\";import{getMockSenderEnhancer}from\"@rpldy/mock-sender\";import UploadButton from\"@rpldy/upload-button\";import UploadPreview,{PREVIEW_TYPES}from\"@rpldy/upload-preview\";import cropImage from\"./crop\";import\"./style.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var StyledReactCrop=styled(ReactCrop)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  max-width: 900px;\\n  height: 400px;\\n\"])));var PreviewImage=styled.img(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin: 5px;\\n  max-width: 200px;\\n  height: auto;\\n  max-height: 200px;\\n\"])));var ButtonsWrapper=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  margin-top: 10px;\\n\"])));var PreviewButtons=function PreviewButtons(props){var finished=props.finished,crop=props.crop,updateRequest=props.updateRequest,onUploadCancel=props.onUploadCancel,onUploadCrop=props.onUploadCrop;return/*#__PURE__*/_jsxs(ButtonsWrapper,{children:[/*#__PURE__*/_jsx(\"button\",{style:{display:!finished&&updateRequest&&crop?\"block\":\"none\"},onClick:onUploadCrop,children:\"Upload Cropped\"}),/*#__PURE__*/_jsx(\"button\",{style:{display:!finished&&updateRequest?\"block\":\"none\"},onClick:updateRequest,children:\"Upload without Crop\"}),/*#__PURE__*/_jsx(\"button\",{style:{display:!finished&&updateRequest&&crop?\"block\":\"none\"},onClick:onUploadCancel,children:\"Cancel\"})]});};var ItemPreviewWithCrop=withRequestPreSendUpdate(function(props){var id=props.id,url=props.url,isFallback=props.isFallback,type=props.type,updateRequest=props.updateRequest,requestData=props.requestData,previewMethods=props.previewMethods;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),finished=_useState2[0],setFinished=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),crop=_useState4[0],setCrop=_useState4[1];useItemFinalizeListener(function(){setFinished(true);},id);var onUploadCrop=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(updateRequest&&((crop===null||crop===void 0?void 0:crop.height)||(crop===null||crop===void 0?void 0:crop.width)))){_context.next=5;break;}_context.next=3;return cropImage(url,requestData.items[0].file,crop);case 3:requestData.items[0].file=_context.sent;updateRequest({items:requestData.items});case 5:case\"end\":return _context.stop();}}},_callee);})),[url,requestData,updateRequest,crop]);var onUploadCancel=useCallback(function(){var _previewMethods$curre;updateRequest(false);if((_previewMethods$curre=previewMethods.current)===null||_previewMethods$curre===void 0?void 0:_previewMethods$curre.clear){previewMethods.current.clear();}},[updateRequest,previewMethods]);return isFallback||type!==PREVIEW_TYPES.IMAGE?/*#__PURE__*/_jsx(PreviewImage,{src:url,alt:\"fallback img\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[requestData&&!finished?/*#__PURE__*/_jsx(StyledReactCrop,{src:url,crop:crop,onChange:setCrop,onComplete:setCrop}):/*#__PURE__*/_jsx(PreviewImage,{src:url,alt:\"uploading img\"}),/*#__PURE__*/_jsx(PreviewButtons,{finished:finished,crop:crop,updateRequest:updateRequest,onUploadCancel:onUploadCancel,onUploadCrop:onUploadCrop}),/*#__PURE__*/_jsx(\"p\",{children:finished?\"FINISHED\":\"\"})]});});var mockSenderEnhancer=getMockSenderEnhancer({delay:1500});export default function App(){var previewMethodsRef=useRef();return/*#__PURE__*/_jsx(Uploady,{destination:{url:\"[upload-url]\"},enhancer:mockSenderEnhancer,children:/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Hello React Uploady\"}),/*#__PURE__*/_jsx(UploadButton,{children:\"Upload Files\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(UploadPreview,{PreviewComponent:ItemPreviewWithCrop,previewComponentProps:{previewMethods:previewMethodsRef},previewMethodsRef:previewMethodsRef,fallbackUrl:\"https://icon-library.net/images/image-placeholder-icon/image-placeholder-icon-6.jpg\"})]})});}","map":{"version":3,"sources":["/home/user/Desktop/react_board/boards/boards-ui/src/components/account/my_account2.js"],"names":["React","useState","useCallback","useRef","styled","ReactCrop","Uploady","withRequestPreSendUpdate","useItemFinalizeListener","getMockSenderEnhancer","UploadButton","UploadPreview","PREVIEW_TYPES","cropImage","StyledReactCrop","PreviewImage","img","ButtonsWrapper","div","PreviewButtons","props","finished","crop","updateRequest","onUploadCancel","onUploadCrop","display","ItemPreviewWithCrop","id","url","isFallback","type","requestData","previewMethods","setFinished","setCrop","height","width","items","file","current","clear","IMAGE","mockSenderEnhancer","delay","App","previewMethodsRef"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useRef } from \"react\";\nimport styled from \"styled-components\";\nimport ReactCrop from \"react-image-crop\";\nimport \"react-image-crop/dist/ReactCrop.css\";\nimport Uploady, {\n  withRequestPreSendUpdate,\n  useItemFinalizeListener\n} from \"@rpldy/uploady\";\nimport { getMockSenderEnhancer } from \"@rpldy/mock-sender\";\nimport UploadButton from \"@rpldy/upload-button\";\nimport UploadPreview, { PREVIEW_TYPES } from \"@rpldy/upload-preview\";\nimport cropImage from \"./crop\";\nimport \"./style.css\";\n\nconst StyledReactCrop = styled(ReactCrop)`\n  width: 100%;\n  max-width: 900px;\n  height: 400px;\n`;\n\nconst PreviewImage = styled.img`\n  margin: 5px;\n  max-width: 200px;\n  height: auto;\n  max-height: 200px;\n`;\n\nconst ButtonsWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-top: 10px;\n`;\n\nconst PreviewButtons = (props) => {\n  const { finished, crop, updateRequest, onUploadCancel, onUploadCrop } = props;\n\n  return (\n    <ButtonsWrapper>\n      <button\n        style={{\n          display: !finished && updateRequest && crop ? \"block\" : \"none\"\n        }}\n        onClick={onUploadCrop}\n      >\n        Upload Cropped\n      </button>\n      <button\n        style={{ display: !finished && updateRequest ? \"block\" : \"none\" }}\n        onClick={updateRequest}\n      >\n        Upload without Crop\n      </button>\n      <button\n        style={{\n          display: !finished && updateRequest && crop ? \"block\" : \"none\"\n        }}\n        onClick={onUploadCancel}\n      >\n        Cancel\n      </button>\n    </ButtonsWrapper>\n  );\n};\n\nconst ItemPreviewWithCrop = withRequestPreSendUpdate((props) => {\n  const {\n    id,\n    url,\n    isFallback,\n    type,\n    updateRequest,\n    requestData,\n    previewMethods\n  } = props;\n  const [finished, setFinished] = useState(false);\n  const [crop, setCrop] = useState(null);\n\n  useItemFinalizeListener(() => {\n    setFinished(true);\n  }, id);\n\n  const onUploadCrop = useCallback(async () => {\n    if (updateRequest && (crop?.height || crop?.width)) {\n      requestData.items[0].file = await cropImage(\n        url,\n        requestData.items[0].file,\n        crop\n      );\n      updateRequest({ items: requestData.items });\n    }\n  }, [url, requestData, updateRequest, crop]);\n\n  const onUploadCancel = useCallback(() => {\n    updateRequest(false);\n    if (previewMethods.current?.clear) {\n      previewMethods.current.clear();\n    }\n  }, [updateRequest, previewMethods]);\n\n  return isFallback || type !== PREVIEW_TYPES.IMAGE ? (\n    <PreviewImage src={url} alt=\"fallback img\" />\n  ) : (\n    <>\n      {requestData && !finished ? (\n        <StyledReactCrop\n          src={url}\n          crop={crop}\n          onChange={setCrop}\n          onComplete={setCrop}\n        />\n      ) : (\n        <PreviewImage src={url} alt=\"uploading img\" />\n      )}\n      <PreviewButtons\n        finished={finished}\n        crop={crop}\n        updateRequest={updateRequest}\n        onUploadCancel={onUploadCancel}\n        onUploadCrop={onUploadCrop}\n      />\n      <p>{finished ? \"FINISHED\" : \"\"}</p>\n    </>\n  );\n});\n\nconst mockSenderEnhancer = getMockSenderEnhancer({ delay: 1500 });\n\nexport default function App() {\n  const previewMethodsRef = useRef();\n\n  return (\n    <Uploady\n      destination={{ url: \"[upload-url]\" }}\n      enhancer={mockSenderEnhancer}\n    >\n      <div className=\"App\">\n        <h1>Hello React Uploady</h1>\n        <UploadButton>Upload Files</UploadButton>\n        <br />\n        <UploadPreview\n          PreviewComponent={ItemPreviewWithCrop}\n          previewComponentProps={{ previewMethods: previewMethodsRef }}\n          previewMethodsRef={previewMethodsRef}\n          fallbackUrl=\"https://icon-library.net/images/image-placeholder-icon/image-placeholder-icon-6.jpg\"\n        />\n      </div>\n    </Uploady>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}