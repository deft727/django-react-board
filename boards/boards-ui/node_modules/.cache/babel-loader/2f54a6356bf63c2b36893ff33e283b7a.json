{"ast":null,"code":"import _slicedToArray from \"/home/user/Desktop/react_board/boards/boards-ui/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport React, { useLayoutEffect, useState } from \"react\";\nimport { UPLOADER_EVENTS } from \"@rpldy/uploader\";\nimport useUploadyContext from \"./useUploadyContext\";\nexport default (function (Component) {\n  return function (props) {\n    var context = useUploadyContext();\n    var id = props.id;\n\n    var _useState = useState({\n      update: null,\n      data: null\n    }),\n        _useState2 = _slicedToArray(_useState, 2),\n        updater = _useState2[0],\n        setUpdater = _useState2[1]; //need layout effect to register for REQUEST_PRE_SEND in time (block)\n\n\n    useLayoutEffect(function () {\n      var handleRequestPreSend = function handleRequestPreSend(requestData) {\n        return requestData.items.find(function (item) {\n          return item.id === id;\n        }) && new Promise(function (resolve) {\n          setUpdater(function () {\n            return {\n              update: function update(data) {\n                //unregister handler so this instance doesnt continue listening unnecessarily\n                context.off(UPLOADER_EVENTS.REQUEST_PRE_SEND, handleRequestPreSend);\n                resolve(data);\n              },\n              data: requestData\n            };\n          });\n        });\n      };\n\n      if (id) {\n        context.on(UPLOADER_EVENTS.REQUEST_PRE_SEND, handleRequestPreSend);\n      }\n\n      return function () {\n        if (id) {\n          context.off(UPLOADER_EVENTS.REQUEST_PRE_SEND, handleRequestPreSend);\n        }\n      };\n    }, [context, id]);\n    return /*#__PURE__*/React.createElement(Component, _extends({}, props, {\n      updateRequest: updater.update,\n      requestData: updater.data\n    }));\n  };\n});","map":{"version":3,"sources":["/home/user/Desktop/react_board/boards/boards-ui/node_modules/@rpldy/shared-ui/lib/esm/withRequestPreSendUpdate.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","React","useLayoutEffect","useState","UPLOADER_EVENTS","useUploadyContext","Component","props","context","id","update","data","updater","setUpdater","handleRequestPreSend","requestData","items","find","item","Promise","resolve","off","REQUEST_PRE_SEND","on","createElement","updateRequest"],"mappings":";;AAAA,SAASA,QAAT,GAAoB;AAAEA,EAAAA,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAAUC,MAAV,EAAkB;AAAE,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,UAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAtB;;AAA2B,WAAK,IAAII,GAAT,IAAgBD,MAAhB,EAAwB;AAAE,YAAIN,MAAM,CAACQ,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCJ,MAArC,EAA6CC,GAA7C,CAAJ,EAAuD;AAAEL,UAAAA,MAAM,CAACK,GAAD,CAAN,GAAcD,MAAM,CAACC,GAAD,CAApB;AAA4B;AAAE;AAAE;;AAAC,WAAOL,MAAP;AAAgB,GAA5P;;AAA8P,SAAOH,QAAQ,CAACY,KAAT,CAAe,IAAf,EAAqBP,SAArB,CAAP;AAAyC;;AAE7T,OAAOQ,KAAP,IAAgBC,eAAhB,EAAiCC,QAAjC,QAAiD,OAAjD;AACA,SAASC,eAAT,QAAgC,iBAAhC;AACA,OAAOC,iBAAP,MAA8B,qBAA9B;AACA,gBAAgB,UAAAC,SAAS;AAAA,SAAI,UAAAC,KAAK,EAAI;AACpC,QAAMC,OAAO,GAAGH,iBAAiB,EAAjC;AACA,QACEI,EADF,GAEIF,KAFJ,CACEE,EADF;;AAGA,oBAA8BN,QAAQ,CAAC;AACrCO,MAAAA,MAAM,EAAE,IAD6B;AAErCC,MAAAA,IAAI,EAAE;AAF+B,KAAD,CAAtC;AAAA;AAAA,QAAOC,OAAP;AAAA,QAAgBC,UAAhB,iBALoC,CAQhC;;;AAEJX,IAAAA,eAAe,CAAC,YAAM;AACpB,UAAMY,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAAC,WAAW;AAAA,eAAIA,WAAW,CAACC,KAAZ,CAAkBC,IAAlB,CAAuB,UAAAC,IAAI;AAAA,iBAAIA,IAAI,CAACT,EAAL,KAAYA,EAAhB;AAAA,SAA3B,KAAkD,IAAIU,OAAJ,CAAY,UAAAC,OAAO,EAAI;AACnHP,UAAAA,UAAU,CAAC;AAAA,mBAAO;AAChBH,cAAAA,MAAM,EAAE,gBAAAC,IAAI,EAAI;AACd;AACAH,gBAAAA,OAAO,CAACa,GAAR,CAAYjB,eAAe,CAACkB,gBAA5B,EAA8CR,oBAA9C;AACAM,gBAAAA,OAAO,CAACT,IAAD,CAAP;AACD,eALe;AAMhBA,cAAAA,IAAI,EAAEI;AANU,aAAP;AAAA,WAAD,CAAV;AAQD,SAT6F,CAAtD;AAAA,OAAxC;;AAWA,UAAIN,EAAJ,EAAQ;AACND,QAAAA,OAAO,CAACe,EAAR,CAAWnB,eAAe,CAACkB,gBAA3B,EAA6CR,oBAA7C;AACD;;AAED,aAAO,YAAM;AACX,YAAIL,EAAJ,EAAQ;AACND,UAAAA,OAAO,CAACa,GAAR,CAAYjB,eAAe,CAACkB,gBAA5B,EAA8CR,oBAA9C;AACD;AACF,OAJD;AAKD,KArBc,EAqBZ,CAACN,OAAD,EAAUC,EAAV,CArBY,CAAf;AAsBA,WAAO,aAAaR,KAAK,CAACuB,aAAN,CAAoBlB,SAApB,EAA+BlB,QAAQ,CAAC,EAAD,EAAKmB,KAAL,EAAY;AACrEkB,MAAAA,aAAa,EAAEb,OAAO,CAACF,MAD8C;AAErEK,MAAAA,WAAW,EAAEH,OAAO,CAACD;AAFgD,KAAZ,CAAvC,CAApB;AAID,GApCwB;AAAA,CAAzB","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useLayoutEffect, useState } from \"react\";\nimport { UPLOADER_EVENTS } from \"@rpldy/uploader\";\nimport useUploadyContext from \"./useUploadyContext\";\nexport default (Component => props => {\n  const context = useUploadyContext();\n  const {\n    id\n  } = props;\n  const [updater, setUpdater] = useState({\n    update: null,\n    data: null\n  }); //need layout effect to register for REQUEST_PRE_SEND in time (block)\n\n  useLayoutEffect(() => {\n    const handleRequestPreSend = requestData => requestData.items.find(item => item.id === id) && new Promise(resolve => {\n      setUpdater(() => ({\n        update: data => {\n          //unregister handler so this instance doesnt continue listening unnecessarily\n          context.off(UPLOADER_EVENTS.REQUEST_PRE_SEND, handleRequestPreSend);\n          resolve(data);\n        },\n        data: requestData\n      }));\n    });\n\n    if (id) {\n      context.on(UPLOADER_EVENTS.REQUEST_PRE_SEND, handleRequestPreSend);\n    }\n\n    return () => {\n      if (id) {\n        context.off(UPLOADER_EVENTS.REQUEST_PRE_SEND, handleRequestPreSend);\n      }\n    };\n  }, [context, id]);\n  return /*#__PURE__*/React.createElement(Component, _extends({}, props, {\n    updateRequest: updater.update,\n    requestData: updater.data\n  }));\n});"]},"metadata":{},"sourceType":"module"}