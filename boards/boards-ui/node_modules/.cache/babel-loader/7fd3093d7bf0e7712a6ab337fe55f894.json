{"ast":null,"code":"import React,{useState}from'react';import'bootstrap/dist/css/bootstrap.min.css';import{Modal,Button}from'react-bootstrap';import{withFormik,Form,Field,Formik}from'formik';import*as Yup from\"yup\";import{withRouter}from\"react-router-dom\";import FormData from'form-data';var axios=require('axios');import yup from\"yup\";import Dropzone from\"react-dropzone\";import Thumb from\"../Thumb/thumb\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function NewTopic(props){var openTopic=props.openTopic,handleCloseTopic=props.handleCloseTopic,history=props.history,match=props.match;var id=match.params.id;var tokens=localStorage.tokens;var validationSchema=Yup.object().shape({subject:Yup.string().required('subject is wrong')},[id]);var dropzoneStyle={width:\"100%\",height:\"auto\",borderWidth:2,borderColor:\"rgb(102, 102, 102)\",borderStyle:\"dashed\",borderRadius:5};var handleSubmit=function handleSubmit(values){var data=new FormData();data.append('file',values.file,values.file.name);data.append('subject',values.subject);// console.log(\"data\", data)\nconsole.log(\"values\",values.file.name);var REST_API_URL=\"http://127.0.0.1:8000/api/board/\".concat(id,\"/new/\");axios.post(REST_API_URL,data,{headers:{'accept':'application/json','Accept-Language':'en-US,en;q=0.8','Content-Type':\"multipart/form-data\",'Authorization':\"Token \".concat(tokens)}}).then(function(response){if(response.status===201){alert(\"Success\");handleCloseTopic();}else{alert(\"error\");handleCloseTopic();// window.location.reload();\nthrow new Error('Something went wrong');}});};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Modal,{show:openTopic,onHide:handleCloseTopic,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\" New Topic \"})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(Formik,{initialValues:{subject:\"\"},onSubmit:handleSubmit,validationSchema:validationSchema,children:function children(props){return/*#__PURE__*/_jsxs(Form,{className:\"form-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",children:\"subject\"}),/*#__PURE__*/_jsx(Field,{type:\"text\",name:\"subject\",id:\"subject\",className:\"form-control \",placeholder:\"subject\"}),props.touched.subject&&props.errors.subject&&/*#__PURE__*/_jsx(\"span\",{className:\"help-block text-danger\",children:props.errors.subject}),/*#__PURE__*/_jsx(Dropzone,{style:dropzoneStyle,accept:\"image/*\",onDrop:function onDrop(acceptedFiles){// do nothing if no files\nif(acceptedFiles.length===0){return;}// on drop we add to the existing files\nsetFieldValue(\"files\",props.files.concat(acceptedFiles));},children:function children(_ref){var isDragActive=_ref.isDragActive,isDragReject=_ref.isDragReject,acceptedFiles=_ref.acceptedFiles,rejectedFiles=_ref.rejectedFiles;if(isDragActive){return\"This file is authorized\";}if(isDragReject){return\"This file is not authorized\";}if(props.files.length===0){return/*#__PURE__*/_jsx(\"p\",{children:\"Try dragging a file here!\"});}return props.files.map(function(file,i){return/*#__PURE__*/_jsx(Thumb,{file:file},i);});}})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleCloseTopic,children:\"Close\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary mb-2\",children:\"Create \"})]})]});}})})})]})});}export default withRouter(NewTopic);","map":{"version":3,"sources":["/home/user/Desktop/react_board/boards/boards-ui/src/components/NewTopic/newtopic.js"],"names":["React","useState","Modal","Button","withFormik","Form","Field","Formik","Yup","withRouter","FormData","axios","require","yup","Dropzone","Thumb","NewTopic","props","openTopic","handleCloseTopic","history","match","id","params","tokens","localStorage","validationSchema","object","shape","subject","string","required","dropzoneStyle","width","height","borderWidth","borderColor","borderStyle","borderRadius","handleSubmit","values","data","append","file","name","console","log","REST_API_URL","post","headers","then","response","status","alert","Error","touched","errors","acceptedFiles","length","setFieldValue","files","concat","isDragActive","isDragReject","rejectedFiles","map","i"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { Modal, Button } from 'react-bootstrap'\nimport { withFormik, Form, Field, Formik } from 'formik';\nimport * as Yup from \"yup\";\nimport {withRouter} from \"react-router-dom\";\nimport FormData from 'form-data';\nconst axios = require('axios');\nimport yup from \"yup\";\nimport Dropzone from \"react-dropzone\";\nimport Thumb from \"../Thumb/thumb\";\n\nfunction NewTopic(props) {\n    const{openTopic,handleCloseTopic,history,match} = props;\n    const id = match.params.id\n    const tokens = localStorage.tokens;\n    const  validationSchema = Yup.object().shape({\n    subject: Yup.string().required('subject is wrong'),\n  }, [id])\n\nconst dropzoneStyle = {\n  width: \"100%\",\n  height: \"auto\",\n  borderWidth: 2,\n  borderColor: \"rgb(102, 102, 102)\",\n  borderStyle: \"dashed\",\n  borderRadius: 5,\n}\n  const handleSubmit = (values) => {\n    let data = new FormData();\n     data.append('file', values.file, values.file.name,);\n     data.append('subject', values.subject);\n    // console.log(\"data\", data)\n    console.log(\"values\", values.file.name)\n    const REST_API_URL = `http://127.0.0.1:8000/api/board/${id}/new/`;\n    axios.post(REST_API_URL, data, {\n  headers: {\n    'accept': 'application/json',\n    'Accept-Language': 'en-US,en;q=0.8',\n    'Content-Type': `multipart/form-data`,\n    'Authorization': `Token ${tokens}`,\n  }\n})\n  .then((response) => {\n      if (response.status===201) {\n          alert(\"Success\");\n            handleCloseTopic()\n      }\n      else {\n          alert(\"error\");\n          handleCloseTopic()\n          // window.location.reload();\n        throw new Error('Something went wrong');\n      }\n  });\n  }\n  return (\n    <div>\n      <Modal show={openTopic} onHide={handleCloseTopic}>\n\n        <Modal.Header closeButton>\n          <Modal.Title> New Topic </Modal.Title>\n        </Modal.Header>\n\n        <Modal.Body>\n<React.Fragment>\n\n          <Formik\n       initialValues={{ subject: \"\" }}\n       onSubmit={handleSubmit}\n       validationSchema={validationSchema}\n     >\n       {props => (\n          <Form className=\"form-container\">\n            <div className=\"form-group\">\n              <label htmlFor=\"name\">subject</label>\n              <Field type=\"text\" name=\"subject\" id={\"subject\"} className={\"form-control \"} placeholder=\"subject\" />\n              { props.touched.subject && props.errors.subject && <span className=\"help-block text-danger\">{props.errors.subject}</span> }\n\n            {/*   <input*/}\n            {/*  multiple={true}*/}\n            {/*  type=\"file\"*/}\n            {/*  name=\"file\"*/}\n            {/*  onChange={(event) =>{*/}\n            {/*    props.setFieldValue(\"file\", event.target.files[0]);*/}\n            {/*  }}*/}\n            {/*/>*/}\n <Dropzone style={dropzoneStyle} accept=\"image/*\" onDrop={(acceptedFiles) => {\n              // do nothing if no files\n              if (acceptedFiles.length === 0) { return; }\n\n              // on drop we add to the existing files\n              setFieldValue(\"files\", props.files.concat(acceptedFiles));\n            }}>\n              {({ isDragActive, isDragReject, acceptedFiles, rejectedFiles }) => {\n                if (isDragActive) {\n                  return \"This file is authorized\";\n                }\n\n                if (isDragReject) {\n                  return \"This file is not authorized\";\n                }\n\n                if (props.files.length === 0) {\n                  return <p>Try dragging a file here!</p>\n                }\n\n                return props.files.map((file, i) => (<Thumb key={i} file={file} />));\n              }}\n            </Dropzone>\n\n            </div>\n\n        <Modal.Footer>\n\n          <Button variant=\"secondary\" onClick={handleCloseTopic}>Close</Button>\n                  <button type=\"submit\" className=\"btn btn-primary mb-2\">Create </button>\n\n        </Modal.Footer>\n          </Form>)}\n             </Formik>\n\n    </React.Fragment>\n\n        </Modal.Body>\n\n\n      </Modal>\n\n    </div>\n  );\n}\n\nexport default withRouter(NewTopic);"]},"metadata":{},"sourceType":"module"}